Кубический сплайн соединяет узловые точки так, чтобы сохранить **гладкость** и **непрерывность** функции и её первых двух производных на каждом интервале. Этот процесс основан на решении системы уравнений, которая гарантирует, что отдельные куски полиномов \(S_i(x)\) согласованы между собой. Вот как это работает:

---

### Условия для соединения узлов:

1. **Непрерывность самой функции**:
   - На границах каждого интервала \([x_i, x_{i+1}]\) значения сплайна совпадают с узловыми значениями:
     \[
     S_i(x_i) = y_i, \quad S_i(x_{i+1}) = y_{i+1}.
     \]
   - Это обеспечивает плавное соединение на уровне функции.

2. **Непрерывность первой производной**:
   - Первая производная \(S'_i(x)\) должна совпадать на границах интервалов:
     \[
     S'_i(x_{i+1}) = S'_{i+1}(x_{i+1}).
     \]
   - Это делает переход между интервалами гладким (без "изломов").

3. **Непрерывность второй производной**:
   - Вторая производная \(S''_i(x)\) также должна совпадать:
     \[
     S''_i(x_{i+1}) = S''_{i+1}(x_{i+1}).
     \]
   - Это делает кривизну функции плавной.

4. **Граничные условия**:
   - Для решения системы уравнений применяются дополнительные условия на концах интервала:
     - *Естественные граничные условия*: \(S''(x_0) = 0\) и \(S''(x_n) = 0\) (нулевая кривизна на концах).
     - Либо другие типы условий, например, заданные значения производных на концах.

---

### Как это реализуется в коде:

1. **Полином для каждого интервала**:
   - Сплайн на каждом интервале \( [x_i, x_{i+1}] \) записывается как кубический полином:
     \[
     S_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2 + d_i (x - x_i)^3.
     \]
   - Коэффициенты \(a_i, b_i, c_i, d_i\) определяют форму кривой на интервале.

2. **Система уравнений**:
   - Используется трёхдиагональная система уравнений для нахождения коэффициентов \(c_i\), которые задают вторую производную. Эта система строится из:
     - Условий на стыки интервалов (непрерывность первой и второй производных),
     - Граничных условий.

3. **Вспомогательные вычисления**:
   - После нахождения \(c_i\) вычисляются:
     - \(b_i\): связаны с наклоном функции,
     - \(d_i\): определяют степень изменения кривизны,
     - \(a_i\): равны значениям функции в узловых точках (\(a_i = y_i\)).

4. **Построение сплайна**:
   - Для каждой точки в пределах интервала \([x_i, x_{i+1}]\) значение сплайна вычисляется как:
     \[
     S_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2 + d_i (x - x_i)^3.
     \]

---

### Алгоритм соединения узлов:

1. **Подготовка данных**:
   - Узловые точки (\(x_i, y_i\)) фиксируются.
   - Вычисляются длины интервалов (\(h_i = x_{i+1} - x_i\)).

2. **Решение системы уравнений**:
   - Составляется трёхдиагональная матрица, где каждая строка отвечает за условия на второй производной.
   - Решение даёт значения \(c_i\) для каждого интервала.

3. **Вывод коэффициентов**:
   - После нахождения \(c_i\) последовательно вычисляются \(b_i\) и \(d_i\).

4. **Сборка полиномов**:
   - На каждом интервале строится полином \(S_i(x)\).

---

### Пример соединения:

#### Для интервала \([-10, -5]\):
- Полином:
  \[
  S_0(x) = 9.000213927120674 - 1.0402628531877731 (x + 10) + 0.004670619698888203 (x + 10)^3.
  \]

#### Для интервала \([-5, 0]\):
- Полином:
  \[
  S_1(x) = 4.382727123542834 - 0.6899663757711577 (x + 5) + 0.07005929548332306 (x + 5)^2 - 0.01347502105416097 (x + 5)^3.
  \]

---

### Итог:
Сплайн "понимает", как соединять узлы, благодаря строгим математическим условиям на непрерывность и гладкость. Решение линейной системы уравнений автоматически обеспечивает, что каждый интервал согласован с соседними.